<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>js基础 | web-doc</title>
    <meta name="generator" content="VuePress 1.5.2">
    
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/web-doc/assets/css/0.styles.ecab9e36.css" as="style"><link rel="preload" href="/web-doc/assets/js/app.d31740f5.js" as="script"><link rel="preload" href="/web-doc/assets/js/2.b96ff054.js" as="script"><link rel="preload" href="/web-doc/assets/js/31.9203bd46.js" as="script"><link rel="prefetch" href="/web-doc/assets/js/10.d87c9d75.js"><link rel="prefetch" href="/web-doc/assets/js/11.b500294b.js"><link rel="prefetch" href="/web-doc/assets/js/12.5b93838d.js"><link rel="prefetch" href="/web-doc/assets/js/13.c3f18a0f.js"><link rel="prefetch" href="/web-doc/assets/js/14.fdc6937b.js"><link rel="prefetch" href="/web-doc/assets/js/15.64cdbd27.js"><link rel="prefetch" href="/web-doc/assets/js/16.ae3e3a81.js"><link rel="prefetch" href="/web-doc/assets/js/17.0cc950c7.js"><link rel="prefetch" href="/web-doc/assets/js/18.e4960d43.js"><link rel="prefetch" href="/web-doc/assets/js/19.7eb0a697.js"><link rel="prefetch" href="/web-doc/assets/js/20.6f9cfbb3.js"><link rel="prefetch" href="/web-doc/assets/js/21.08d4a7de.js"><link rel="prefetch" href="/web-doc/assets/js/22.0ccf9aff.js"><link rel="prefetch" href="/web-doc/assets/js/23.469a29ee.js"><link rel="prefetch" href="/web-doc/assets/js/24.244bf57c.js"><link rel="prefetch" href="/web-doc/assets/js/25.41204146.js"><link rel="prefetch" href="/web-doc/assets/js/26.41cb4c77.js"><link rel="prefetch" href="/web-doc/assets/js/27.362e59fd.js"><link rel="prefetch" href="/web-doc/assets/js/28.27fd6a23.js"><link rel="prefetch" href="/web-doc/assets/js/29.65481466.js"><link rel="prefetch" href="/web-doc/assets/js/3.62a12f98.js"><link rel="prefetch" href="/web-doc/assets/js/30.cc12544f.js"><link rel="prefetch" href="/web-doc/assets/js/32.f7ca5627.js"><link rel="prefetch" href="/web-doc/assets/js/4.45bc3a19.js"><link rel="prefetch" href="/web-doc/assets/js/5.91df2f8f.js"><link rel="prefetch" href="/web-doc/assets/js/6.fe0d32c9.js"><link rel="prefetch" href="/web-doc/assets/js/7.eb2cf8d1.js"><link rel="prefetch" href="/web-doc/assets/js/8.fa266553.js"><link rel="prefetch" href="/web-doc/assets/js/9.8ffe47f8.js">
    <link rel="stylesheet" href="/web-doc/assets/css/0.styles.ecab9e36.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web-doc/" class="home-link router-link-active"><!----> <span class="site-name">web-doc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/web-doc/vue/" class="nav-link">
  vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微信" class="dropdown-title"><span class="title">微信</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-doc/wechat/小程序/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/wechat/公众号/" class="nav-link">
  公众号
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端工具" class="dropdown-title"><span class="title">前端工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-doc/前端工具/版本控制工具/" class="nav-link">
  版本控制工具
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/前端工具/开发编辑器/" class="nav-link">
  开发编辑器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试题" class="dropdown-title"><span class="title">面试题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-doc/面试题/html/" class="nav-link">
  html
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/面试题/js/" class="nav-link">
  js
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/面试题/css/" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/面试题/各种原理/" class="nav-link">
  各种原理
</a></li></ul></div></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/web-doc/vue/" class="nav-link">
  vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="微信" class="dropdown-title"><span class="title">微信</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-doc/wechat/小程序/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/wechat/公众号/" class="nav-link">
  公众号
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端工具" class="dropdown-title"><span class="title">前端工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-doc/前端工具/版本控制工具/" class="nav-link">
  版本控制工具
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/前端工具/开发编辑器/" class="nav-link">
  开发编辑器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试题" class="dropdown-title"><span class="title">面试题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-doc/面试题/html/" class="nav-link">
  html
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/面试题/js/" class="nav-link">
  js
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/面试题/css/" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/web-doc/面试题/各种原理/" class="nav-link">
  各种原理
</a></li></ul></div></div><div class="nav-item"><a href="https://v1.vuepress.vuejs.org" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>js</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/" aria-current="page" class="active sidebar-link">js基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#一-js数据类型有哪些？值是如何存储的" class="sidebar-link">一.js数据类型有哪些？值是如何存储的</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#二-js数据类型转换" class="sidebar-link">二.js数据类型转换</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#三-js数据类型判断方法" class="sidebar-link">三.js数据类型判断方法</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#四-javascript中的对象分类" class="sidebar-link">四.JavaScript中的对象分类</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#五-创建对象的几种方式" class="sidebar-link">五.创建对象的几种方式</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#六-js继承的几种方式" class="sidebar-link">六.js继承的几种方式</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#七-浅拷贝和深拷贝" class="sidebar-link">七.浅拷贝和深拷贝</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#八-事件传播的三个阶段" class="sidebar-link">八.事件传播的三个阶段</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#九-es6新增方法" class="sidebar-link">九.ES6新增方法</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#十-防抖和节流" class="sidebar-link">十.防抖和节流</a></li><li class="sidebar-sub-header"><a href="/web-doc/%E9%9D%A2%E8%AF%95%E9%A2%98/js/#十一-闭包" class="sidebar-link">十一.闭包</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="js基础"><a href="#js基础" class="header-anchor">#</a> js基础</h1> <h2 id="一-js数据类型有哪些？值是如何存储的"><a href="#一-js数据类型有哪些？值是如何存储的" class="header-anchor">#</a> 一.js数据类型有哪些？值是如何存储的</h2> <h3 id="一共八种。"><a href="#一共八种。" class="header-anchor">#</a> 一共八种。</h3> <ul><li>基础数据类型:7种：Undefined、Null、Boolean、Number、String、Symbol（es6新增，表示独一无二的值）和BigInt（es10新增）；直接存储在栈（stack）中，占据空间小、大小固定，属于被频繁使用数据，所以放入栈中存储。</li> <li>引用数据类型:1种：Object(function、Array、Date);同时存储在栈（stack）和堆（heap）中，占据空间大、大小不固定。引用数据类型在栈中存储了指针，该指针指向堆中该实体的起始地址。当解释器寻找引用值时，会首先检索其在栈中的地址，取得地址后从堆中获得实体。</li></ul> <h2 id="二-js数据类型转换"><a href="#二-js数据类型转换" class="header-anchor">#</a> 二.js数据类型转换</h2> <h4 id="强制转换"><a href="#强制转换" class="header-anchor">#</a> 强制转换</h4> <h5 id="显示转换一般指使用number、string和boolean三个构造函数，手动将各种类型的值，转换成数字、字符串或者布尔值。"><a href="#显示转换一般指使用number、string和boolean三个构造函数，手动将各种类型的值，转换成数字、字符串或者布尔值。" class="header-anchor">#</a> 显示转换一般指使用Number、String和Boolean三个构造函数，手动将各种类型的值，转换成数字、字符串或者布尔值。</h5> <img src="/web-doc/img.png" alt="mixureSecure">
*注：数组转字符串:数组除了数字字符串及数字数组，其他都是&quot;[object Object]&quot;
 &gt; Jake Zhang
 &gt; https://juejin.im/post/5ef8377f6fb9a07e693a6061
#### 隐式转换
##### 只要是涉及到不同数据类型需要计算的时候都会触发隐式类型转换，然后隐式类型中主要有三种转换方式
<p><img src="https://static001.geekbang.org/resource/image/71/20/71bafbd2404dc3ffa5ccf5d0ba077720.jpg" alt=""></p> <h5 id="如图，任意两种类型比较时，如果不是同一个类型比较的话，则按如图方式进行相应类型转换，如对象和布尔比较的话，对象-字符串-数值-布尔值-数值。undefined与null是特殊情况，undefined-null为true。"><a href="#如图，任意两种类型比较时，如果不是同一个类型比较的话，则按如图方式进行相应类型转换，如对象和布尔比较的话，对象-字符串-数值-布尔值-数值。undefined与null是特殊情况，undefined-null为true。" class="header-anchor">#</a> 如图，任意两种类型比较时，如果不是同一个类型比较的话，则按如图方式进行相应类型转换，如对象和布尔比较的话，对象 =&gt; 字符串 =&gt; 数值 布尔值 =&gt; 数值。undefined与null是特殊情况，undefined==null为true。</h5> <ul><li>== 运算
<ul><li>1.对象和布尔值比较</li></ul></li></ul> <h5 id="对象和布尔值进行比较时，对象先转换为字符串，然后再转换为数字，布尔值直接转换为数字"><a href="#对象和布尔值进行比较时，对象先转换为字符串，然后再转换为数字，布尔值直接转换为数字" class="header-anchor">#</a> 对象和布尔值进行比较时，对象先转换为字符串，然后再转换为数字，布尔值直接转换为数字</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code>      <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">;</span>  <span class="token comment">//false  []转换为字符串'',然后转换为数字0,true转换为数字1，所以为false</span>
</code></pre></div><ul><li><ol start="2"><li>对象和字符串</li></ol></li></ul> <h5 id="对象和字符串进行比较时，对象转换为字符串，然后两者进行比较"><a href="#对象和字符串进行比较时，对象转换为字符串，然后两者进行比较" class="header-anchor">#</a> 对象和字符串进行比较时，对象转换为字符串，然后两者进行比较</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1,2,3'</span> <span class="token comment">// true  [1,2,3]转化为'1,2,3'，然后和'1,2,3'， 所以结果为true;</span>
</code></pre></div><ul><li><ol start="3"><li>对象和数字</li></ol></li></ul> <h5 id="对象和数字进行比较时，对象先转换为字符串，然后转换为数字，再和数字进行比较"><a href="#对象和数字进行比较时，对象先转换为字符串，然后转换为数字，再和数字进行比较" class="header-anchor">#</a> 对象和数字进行比较时，对象先转换为字符串，然后转换为数字，再和数字进行比较</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">;</span>  <span class="token comment">// true  `对象先转换为字符串再转换为数字，二者再比较 [1] =&gt; '1' =&gt; 1 所以结果为true</span>
</code></pre></div><ul><li><ol start="4"><li>字符串和数字</li></ol></li></ul> <h5 id="字符串和数字进行比较时，字符串转换成数字，二者再比较"><a href="#字符串和数字进行比较时，字符串转换成数字，二者再比较" class="header-anchor">#</a> 字符串和数字进行比较时，字符串转换成数字，二者再比较</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'1'</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token comment">// true</span>
</code></pre></div><ul><li><ol start="5"><li>字符串和布尔值</li></ol></li></ul> <h5 id="字符串和布尔值进行比较时，二者全部转换成数值再比较"><a href="#字符串和布尔值进行比较时，二者全部转换成数值再比较" class="header-anchor">#</a> 字符串和布尔值进行比较时，二者全部转换成数值再比较</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'1'</span> <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// true </span>
</code></pre></div><ul><li><ol start="6"><li>布尔值和数字</li></ol></li></ul> <h5 id="布尔值和数字进行比较时，布尔转换为数字，二者比较"><a href="#布尔值和数字进行比较时，布尔转换为数字，二者比较" class="header-anchor">#</a> 布尔值和数字进行比较时，布尔转换为数字，二者比较</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token boolean">true</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token comment">// true</span>
</code></pre></div><ul><li><ol start="7"><li>对象和字符串</li></ol></li></ul> <h5 id="对象和字符串进行比较时，对象转换为字符串，然后两者进行比较-2"><a href="#对象和字符串进行比较时，对象转换为字符串，然后两者进行比较-2" class="header-anchor">#</a> 对象和字符串进行比较时，对象转换为字符串，然后两者进行比较</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'1,2,3'</span> <span class="token comment">// true  [1,2,3]转化为'1,2,3'，然后和'1,2,3'， 所以结果为true;</span>
</code></pre></div><h5 id="一张图说明"><a href="#一张图说明" class="header-anchor">#</a> 一张图说明</h5> <img src="/web-doc/change.png" alt="mixureSecure">
##### 隐式调用默认方法 valueOf()：返回最适合该对象类型的原始值；toString(): 将该对象的原始值以字符串形式返回。
- 这两个方法一般是交由JS去隐式调用，以满足不同的运算情况。
- 在数值运算里，会优先调用valueOf()，如a + b；
- 在字符串运算里，会优先调用toString()，如alert(c)。
<ul><li>（+,-,*,/,%）运算</li></ul> <h5 id="当加号运算符时，string和其他类型时，其他类型都会转为-string；undefined-转化为number是-为-nan-，-任何number与nan相加都为nan。"><a href="#当加号运算符时，string和其他类型时，其他类型都会转为-string；undefined-转化为number是-为-nan-，-任何number与nan相加都为nan。" class="header-anchor">#</a> 当加号运算符时，String和其他类型时，其他类型都会转为 String；undefined 转化为Number是 为'NaN‘， 任何Number与NaN相加都为NaN。</h5> <h5 id="其他运算符时，-基本类型都转换为-number，string类型的带有字符的比如：-1a-a1-转化为-nan-与undefined-一样。"><a href="#其他运算符时，-基本类型都转换为-number，string类型的带有字符的比如：-1a-a1-转化为-nan-与undefined-一样。" class="header-anchor">#</a> 其他运算符时， 基本类型都转换为 Number，String类型的带有字符的比如： '1a' ,'a1' 转化为 NaN 与undefined 一样。</h5> <h4 id="装箱转换"><a href="#装箱转换" class="header-anchor">#</a> 装箱转换</h4> <h5 id="把基本类型转换为对应的对象"><a href="#把基本类型转换为对应的对象" class="header-anchor">#</a> 把基本类型转换为对应的对象</h5> <h4 id="拆箱转换"><a href="#拆箱转换" class="header-anchor">#</a> 拆箱转换</h4> <h5 id="在javascript标准中，规定了-toprimitive-函数，它是对象类型到基本类型的转换"><a href="#在javascript标准中，规定了-toprimitive-函数，它是对象类型到基本类型的转换" class="header-anchor">#</a> 在JavaScript标准中，规定了 ToPrimitive 函数，它是对象类型到基本类型的转换</h5> <h5 id="对象到-string-和-number-的转换都遵循-先拆箱再转换-的规则。通过拆箱转换，把对象变成基本类型，再从基本类型转换为对应的-string-或者-number。"><a href="#对象到-string-和-number-的转换都遵循-先拆箱再转换-的规则。通过拆箱转换，把对象变成基本类型，再从基本类型转换为对应的-string-或者-number。" class="header-anchor">#</a> 对象到 String 和 Number 的转换都遵循“先拆箱再转换”的规则。通过拆箱转换，把对象变成基本类型，再从基本类型转换为对应的 String 或者 Number。</h5> <h5 id="拆箱转换会尝试调用-valueof-和-tostring-来获得拆箱后的基本类型。如果-valueof-和-tostring-都不存在，或者没有返回基本类型，则会产生类型错误-typeerror。"><a href="#拆箱转换会尝试调用-valueof-和-tostring-来获得拆箱后的基本类型。如果-valueof-和-tostring-都不存在，或者没有返回基本类型，则会产生类型错误-typeerror。" class="header-anchor">#</a> 拆箱转换会尝试调用 valueOf 和 toString 来获得拆箱后的基本类型。如果 valueOf 和 toString 都不存在，或者没有返回基本类型，则会产生类型错误 TypeError。</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    例：
   <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">valueOf</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;valueOf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">toString</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;toString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    o <span class="token operator">*</span> <span class="token number">2</span>
    <span class="token comment">// valueOf</span>
    <span class="token comment">// toString</span>
    <span class="token comment">// TypeError</span>

</code></pre></div><ul><li>我们定义了一个对象o，o有valueOf和toString两个方法，这两个方法都返回一个对象，然后我们进行o*2这个运算的时候，你会看见先执行了valueOf，接下来是toString，最后抛出了一个TypeError，这就说明了这个拆箱转换失败了。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>   <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">valueOf</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;valueOf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">toString</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;toString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

   <span class="token function">String</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span>
    <span class="token comment">// toString</span>
    <span class="token comment">// valueOf</span>
    <span class="token comment">// TypeError</span>

</code></pre></div><ul><li>到 String 的拆箱转换会优先调用 toString。我们把刚才的运算从o*2换成 String(o)，那么你会看到调用顺序就变了。</li> <li>在 ES6 之后，还允许对象通过显式指定 @@toPrimitive Symbol 来覆盖原有的行为。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">valueOf</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;valueOf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">toString</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;toString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    o<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>toPrimitive<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;toPrimitive&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token string">&quot;hello&quot;</span><span class="token punctuation">}</span>


    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// toPrimitive</span>
    <span class="token comment">// hello</span>

</code></pre></div><h2 id="三-js数据类型判断方法"><a href="#三-js数据类型判断方法" class="header-anchor">#</a> 三.js数据类型判断方法</h2> <ul><li><ol><li>typeof关键字</li></ol> <h5 id="typeof-对于原始类型来说，除了-null-都可以显示正确的类型"><a href="#typeof-对于原始类型来说，除了-null-都可以显示正确的类型" class="header-anchor">#</a> typeof 对于原始类型来说，除了 null 都可以显示正确的类型</h5></li> <li><ol start="2"><li>instanceof关键字</li></ol></li></ul> <h5 id="instanceof-可以正确的判断对象的类型，因为内部机制是通过判断对象的原型链中是不是能找到类型的-prototype。"><a href="#instanceof-可以正确的判断对象的类型，因为内部机制是通过判断对象的原型链中是不是能找到类型的-prototype。" class="header-anchor">#</a> instanceof 可以正确的判断对象的类型，因为内部机制是通过判断对象的原型链中是不是能找到类型的 prototype。</h5> <ul><li><ol start="3"><li>constructor</li></ol></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Number<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Boolean<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> String<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Function<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
    
</code></pre></div><h5 id="这里有一个坑，如果我创建一个对象，更改它的原型，constructor就会变得不可靠了"><a href="#这里有一个坑，如果我创建一个对象，更改它的原型，constructor就会变得不可靠了" class="header-anchor">#</a> 这里有一个坑，如果我创建一个对象，更改它的原型，constructor就会变得不可靠了</h5> <ul><li><ol start="4"><li>Object.prototype.toString.call() 借用ObjectY原型的 toString 方法</li></ol></li></ul> <h5 id="判断某个对象之属于哪种内置类型"><a href="#判断某个对象之属于哪种内置类型" class="header-anchor">#</a> 判断某个对象之属于哪种内置类型</h5> <h2 id="四-javascript中的对象分类"><a href="#四-javascript中的对象分类" class="header-anchor">#</a> 四.JavaScript中的对象分类</h2> <ul><li><p>宿主对象（host Objects）：由JavaScript宿主环境提供的对象，它们的行为完全由宿主环境决定。</p></li> <li><p>内置对象（Built-in Objects）：由JavaScript语言提供的对象。</p></li></ul> <ol><li>值属性，这些全局属性返回一个简单值，这些值没有自己的属性和方法。</li></ol> <ul><li>例如 Infinity、NaN、undefined、null 字面量</li></ul> <ol start="2"><li>函数属性，全局函数可以直接调用，不需要在调用时指定所属对象，执行结束后会将结果直接返回给调用者。</li></ol> <h5 id="例如-eval-、parsefloat-、parseint-等"><a href="#例如-eval-、parsefloat-、parseint-等" class="header-anchor">#</a> 例如 eval()、parseFloat()、parseInt() 等</h5> <ol start="3"><li>基本对象，基本对象是定义或使用其他对象的基础。基本对象包括一般对象、函数对象和错误对象。</li></ol> <ul><li>例如 Object、Function、Boolean、Symbol、Error 等</li></ul> <ol start="4"><li>数字和日期对象，用来表示数字、日期和执行数学计算的对象。</li></ol> <ul><li>例如 Number、Math、Date</li></ul> <ol start="5"><li>字符串，用来表示和操作字符串的对象。</li></ol> <ul><li>例如 String、RegExp</li></ul> <ol start="6"><li><p>可索引的集合对象，这些对象表示按照索引值来排序的数据集合，包括数组和类型数组，以及类数组结构的对象。例如 Array</p></li> <li><p>使用键的集合对象，这些集合对象在存储数据时会使用到键，支持按照插入顺序来迭代元素。</p></li></ol> <ul><li>例如 Map、Set、WeakMap、WeakSet</li></ul> <ol start="8"><li>矢量集合，SIMD 矢量集合中的数据会被组织为一个数据序列。</li></ol> <ul><li>例如 SIMD 等</li></ul> <ol start="9"><li>结构化数据，这些对象用来表示和操作结构化的缓冲区数据，或使用 JSON 编码的数据。</li></ol> <ul><li>例如 JSON 等</li></ul> <ol start="10"><li>控制抽象对象</li></ol> <ul><li>例如 Promise、Generator 等</li></ul> <ol start="11"><li>反射</li></ol> <ul><li>例如 Reflect、Proxy</li></ul> <ol start="12"><li>国际化，为了支持多语言处理而加入 ECMAScript 的对象。</li></ol> <ul><li>例如 Intl、Intl.Collator 等</li></ul> <ol start="13"><li><p>WebAssembly</p></li> <li><p>其他</p></li></ol> <ul><li>例如 arguments</li></ul> <h2 id="五-创建对象的几种方式"><a href="#五-创建对象的几种方式" class="header-anchor">#</a> 五.创建对象的几种方式</h2> <ol><li>使用字面量的形式直接创建对象，</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> o<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

</code></pre></div><ol start="2"><li>new 操作符 + Object 创建对象</li></ol> <h5 id="以上两种方法在使用同一接口创建多个对象时，会产生大量重复代码"><a href="#以上两种方法在使用同一接口创建多个对象时，会产生大量重复代码" class="header-anchor">#</a> 以上两种方法在使用同一接口创建多个对象时，会产生大量重复代码</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">;</span>
     person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">;</span>

</code></pre></div><ol start="3"><li>工厂模式:主要原理是是用函数来封装创建对象，缺点是没有解决对象区分，并且因为没有new 关键字，与普通函数难以区分</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>family</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    o<span class="token punctuation">.</span>family <span class="token operator">=</span> family<span class="token punctuation">;</span>
    o<span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> o<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span>  <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;lida&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lier&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//instanceof无法判断它是谁的实例，只能判断他是对象，构造函数都可以判断出</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span>  <span class="token function">createPerson</span><span class="token punctuation">(</span><span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;lida&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lier&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1 <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   
</code></pre></div><ol start="4"><li>构造函数模式：函数名大写，将构造函数的作用域赋给新对象，缺点:每个实例都包含不同的Function实例,造成了不必要的函数对象的创建</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>family</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>family <span class="token operator">=</span> family<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;lida&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lier&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;lida&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lier&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1 <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2 <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2 <span class="token keyword">instanceof</span> <span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">.</span>constructor<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token comment">//constructor 属性返回对创建此对象的数组、函数的引用</span>
</code></pre></div><ol start="5"><li>原型模式:使用原型对象来添加公用属性和方法,缺点:1. 所有的属性和方法都共享 2. 不能初始化参数</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">21</span><span class="token punctuation">;</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>family <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;lida&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lier&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">say</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//Object{name: 'lisi', age: 21, family: Array[3]}</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//创建一个实例person1</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//lisi</span>

<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">//创建实例person2</span>
person2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">;</span>
person2<span class="token punctuation">.</span>family <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;lida&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lier&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token comment">//Person {name: &quot;wangwu&quot;, family: Array[3]}</span>
<span class="token comment">// console.log(person2.prototype.name);         //报错</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2<span class="token punctuation">.</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>              <span class="token comment">//21   </span>
</code></pre></div><ol start="6"><li>组合使用构造函数模式和原型模式:构造函数模式用于定义实例属性，原型模式用于定义方法和共享的属性。缺点:使用了两种不同的模式，所以对于代码的封装性不够好</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span>age<span class="token punctuation">,</span>family</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>family <span class="token operator">=</span> family<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Person</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
    constructor<span class="token operator">:</span> Person<span class="token punctuation">,</span>  <span class="token comment">//每个函数都有prototype属性，指向该函数原型对象，原型对象都有constructor属性，这是一个指向prototype属性所在函数的指针</span>
    <span class="token function-variable function">say</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;lida&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lier&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span><span class="token number">21</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;lida&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lier&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="7"><li>动态原型模式:通过对属性是否存在的判断，可以实现仅在第一次调用函数时对原型对象赋值一次的效果</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>job <span class="token operator">=</span> job<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sayName <span class="token operator">!=</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Person</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol start="8"><li>寄生构造函数模式</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
       p<span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
       p<span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
       p<span class="token punctuation">.</span>job <span class="token operator">=</span> job<span class="token punctuation">;</span>
       p<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
       <span class="token punctuation">}</span>
       <span class="token keyword">return</span> p<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
</code></pre></div><h2 id="六-js继承的几种方式"><a href="#六-js继承的几种方式" class="header-anchor">#</a> 六.js继承的几种方式</h2> <ol><li>原型链继承</li></ol> <h4 id="通过子对象的prototype属性指向父对象的实例"><a href="#通过子对象的prototype属性指向父对象的实例" class="header-anchor">#</a> 通过子对象的prototype属性指向父对象的实例</h4> <h4 id="优点：简单易于实现，父类的新增的实例与属性子类都能访问"><a href="#优点：简单易于实现，父类的新增的实例与属性子类都能访问" class="header-anchor">#</a> 优点：简单易于实现，父类的新增的实例与属性子类都能访问</h4> <h4 id="缺点：1）引用类型的属性被所有实例共享-2）创建子类实例时，不能向父类构造函数中传参数"><a href="#缺点：1）引用类型的属性被所有实例共享-2）创建子类实例时，不能向父类构造函数中传参数" class="header-anchor">#</a> 缺点：1）引用类型的属性被所有实例共享 2）创建子类实例时，不能向父类构造函数中传参数</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//父级-构造函数</span>
<span class="token comment">// 原型链继承</span>
<span class="token comment">//父级-构造函数</span>
<span class="token keyword">function</span> <span class="token function">Father</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">this</span><span class="token punctuation">.</span>fatherProp <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
 <span class="token keyword">this</span><span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
 
<span class="token comment">//父级-原型属性</span>
<span class="token class-name">Father</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getFatherValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fatherProp
<span class="token punctuation">}</span>
 
<span class="token comment">//子级-构造函数</span>
<span class="token keyword">function</span> <span class="token function">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">this</span><span class="token punctuation">.</span>sonProp <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
 
<span class="token comment">//子级-原型属性：继承父级</span>
<span class="token comment">//即__proto__指向父级的prototype</span>

<span class="token class-name">Son</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Father</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 
<span class="token comment">//子级-添加原型方法</span>
<span class="token class-name">Son</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getSonValue</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>sonProp
<span class="token punctuation">}</span>
 
<span class="token comment">//创建子级的实例对象</span>
<span class="token keyword">var</span> son <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>son<span class="token punctuation">.</span><span class="token function">getFatherValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//true</span>
 
<span class="token comment">//创建子级的实例对象</span>
<span class="token keyword">var</span> son <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>son<span class="token punctuation">.</span><span class="token function">getFatherValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//true</span>

</code></pre></div><ol start="2"><li>借用构造函数</li></ol> <h4 id="在子级构造函数中调用父级构造函数。"><a href="#在子级构造函数中调用父级构造函数。" class="header-anchor">#</a> 在子级构造函数中调用父级构造函数。</h4> <h4 id="优点：解决了子类构造函数向父类构造函数中传递参数-可以实现多继承（call或者apply多个父类）"><a href="#优点：解决了子类构造函数向父类构造函数中传递参数-可以实现多继承（call或者apply多个父类）" class="header-anchor">#</a> 优点：解决了子类构造函数向父类构造函数中传递参数,可以实现多继承（call或者apply多个父类）</h4> <h4 id="缺点：方法都在构造函数中定义，无法复用-不能继承原型属性-方法，只能继承父类的实例属性和方法"><a href="#缺点：方法都在构造函数中定义，无法复用-不能继承原型属性-方法，只能继承父类的实例属性和方法" class="header-anchor">#</a> 缺点：方法都在构造函数中定义，无法复用,不能继承原型属性/方法，只能继承父类的实例属性和方法</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token keyword">function</span> <span class="token function">Father</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">function</span> <span class="token function">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//call的第一个函数是this指向的对象,即构造函数的实例对象</span>
  <span class="token function">Father</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token comment">// 第二次调用 Parent()</span>
  <span class="token comment">/*上面代码等同于下面这段代码：
  (function() {
   this.arr = [1,2,3]
  }).call(this)
  */</span>
 <span class="token punctuation">}</span>

 <span class="token keyword">var</span> son1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//第一次调用 Parent()</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>son1<span class="token punctuation">.</span>arr<span class="token punctuation">)</span> <span class="token comment">//1,2,3</span>

 <span class="token keyword">var</span> son2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
 son2<span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>

 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>son2<span class="token punctuation">.</span>arr<span class="token punctuation">)</span> <span class="token comment">//1,2,3,4</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>son1<span class="token punctuation">.</span>arr<span class="token punctuation">)</span> <span class="token comment">//1,2,3</span>



</code></pre></div><h4 id="_3-组合继承-共享的用原型链，各自的借用构造函数"><a href="#_3-组合继承-共享的用原型链，各自的借用构造函数" class="header-anchor">#</a> 3.组合继承:共享的用原型链，各自的借用构造函数</h4> <h4 id="优点：融合原型链继承和构造函数的优点，是javascript中最常用的继承模式"><a href="#优点：融合原型链继承和构造函数的优点，是javascript中最常用的继承模式" class="header-anchor">#</a> 优点：融合原型链继承和构造函数的优点，是JavaScript中最常用的继承模式</h4> <h4 id="调用了两次父类构造函数"><a href="#调用了两次父类构造函数" class="header-anchor">#</a> 调用了两次父类构造函数</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">Father</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name
 <span class="token keyword">this</span><span class="token punctuation">.</span>arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token class-name">Father</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Son</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> age</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token function">Father</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span>
 <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age
<span class="token punctuation">}</span>

<span class="token class-name">Son</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Father</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token class-name">Son</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> Son
<span class="token class-name">Son</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getAge</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>age<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> son1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token string">&quot;小名&quot;</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">)</span>
son1<span class="token punctuation">.</span>arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>son1<span class="token punctuation">.</span>arr<span class="token punctuation">)</span> <span class="token comment">//1,2,3,4</span>
son1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">//小名</span>
son1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment">//23</span>

<span class="token keyword">var</span> son2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Son</span><span class="token punctuation">(</span><span class="token string">&quot;一灯&quot;</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>son2<span class="token punctuation">.</span>arr<span class="token punctuation">)</span> <span class="token comment">//1,2,3</span>
son1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment">//一灯</span>
son1<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token comment">//24</span>


</code></pre></div><ol start="4"><li>原型式继承</li></ol> <h4 id="借助原型可以基于已有的对象创建新对象，同时还不必因此创建自定义类型"><a href="#借助原型可以基于已有的对象创建新对象，同时还不必因此创建自定义类型" class="header-anchor">#</a> 借助原型可以基于已有的对象创建新对象，同时还不必因此创建自定义类型</h4> <h4 id="原型式继承的主要思路就是基于已有的对象来创建新的对象，实现的原理是，向函数中传入一个对象，然后返回一个以这个对象为原型的对象。这种继承的思路主要不是为了实现创造一种新的类型，只是对某个对象实现一种简单继承，es5-中定义的-object-create-方法就是原型式继承的实现。缺点与原型链方式相同。"><a href="#原型式继承的主要思路就是基于已有的对象来创建新的对象，实现的原理是，向函数中传入一个对象，然后返回一个以这个对象为原型的对象。这种继承的思路主要不是为了实现创造一种新的类型，只是对某个对象实现一种简单继承，es5-中定义的-object-create-方法就是原型式继承的实现。缺点与原型链方式相同。" class="header-anchor">#</a> 原型式继承的主要思路就是基于已有的对象来创建新的对象，实现的原理是，向函数中传入一个对象，然后返回一个以这个对象为原型的对象。这种继承的思路主要不是为了实现创造一种新的类型，只是对某个对象实现一种简单继承，ES5 中定义的 Object.create() 方法就是原型式继承的实现。缺点与原型链方式相同。</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>        <span class="token comment">// 原型式继承</span>
<span class="token keyword">function</span> <span class="token function">CreateObj</span><span class="token punctuation">(</span><span class="token parameter">o</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">function</span> <span class="token constant">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
            <span class="token class-name">F</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> o<span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">F</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">F</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
            name<span class="token operator">:</span> <span class="token string">'xiaopao'</span><span class="token punctuation">,</span>
            friend<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'daisy'</span><span class="token punctuation">,</span><span class="token string">'kelly'</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token function">CreateObj</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// var person2 = CreateObj(person);</span>

        person1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'person1'</span><span class="token punctuation">;</span>
        <span class="token comment">// console.log(person2.name); // xiaopao</span>
        person1<span class="token punctuation">.</span>friend<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'taylor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// console.log(person2.friend); // [&quot;daisy&quot;, &quot;kelly&quot;, &quot;taylor&quot;]</span>
        <span class="token comment">// console.log(person); // {name: &quot;xiaopao&quot;, friend: Array(3)}</span>
        person1<span class="token punctuation">.</span>friend <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'lulu'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token comment">// console.log(person1.friend); // [&quot;lulu&quot;]</span>
        <span class="token comment">// console.log(person.friend); //  [&quot;daisy&quot;, &quot;kelly&quot;, &quot;taylor&quot;]</span>
        <span class="token comment">// 注意： 这里修改了person1.name的值，person2.name的值并未改变，并不是因为person1和person2有独立的name值，而是person1.name='person1'是给person1添加了name值，并非修改了原型上的name值</span>
        <span class="token comment">// 因为我们找对象上的属性时，总是先找实例上对象，没有找到的话再去原型对象上的属性。实例对象和原型对象上如果有同名属性，总是先取实例对象上的值</span>
</code></pre></div><h2 id="七-浅拷贝和深拷贝"><a href="#七-浅拷贝和深拷贝" class="header-anchor">#</a> 七.浅拷贝和深拷贝</h2> <img src="/web-doc/clone.png" alt="mixureSecure"> <ul><li>浅拷贝:当一个对象拷贝另一个对象的数据的时候，只要一个对象的数据发生改变另一个对象的数据也会发生改变</li></ul> <ol><li>通过Object.assign(),作用：将第二个参数及以后的参数合并到第一个对象里。可实现一维对象的深拷贝</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
      name<span class="token operator">:</span><span class="token string">&quot;tom&quot;</span><span class="token punctuation">,</span>
      age<span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
     <span class="token keyword">var</span> newObj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>newObj<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//输出一个新的对象    </span>
</code></pre></div><ol start="2"><li>使用for  in 循环，遍历每一个属性，将他们赋值给新的对象</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span> a<span class="token operator">:</span> <span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;kaiqin&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">19</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>c<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//多层</span>
<span class="token keyword">function</span> <span class="token function">copy</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> newObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
            newObj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
<span class="token keyword">return</span> newObj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//单层</span>
<span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token function">copy</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj1<span class="token punctuation">.</span>a<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">&quot;wang&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>

</code></pre></div><ol start="3"><li>展开运算符... 作用是把数组或类数组对象展开成一系列用逗号隔开的值</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token punctuation">{</span> name <span class="token operator">:</span> <span class="token string">'hello'</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token punctuation">{</span> …a<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>对组的拷贝方法</li></ul> <ol><li>concat</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token keyword">const</span> originArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cloneArray <span class="token operator">=</span> originArray<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cloneArray <span class="token operator">===</span> originArray<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
cloneArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1,2,3,4,5,6]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originArray<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

</code></pre></div><ol start="2"><li>slice</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> originArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> cloneArray <span class="token operator">=</span> originArray<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>cloneArray <span class="token operator">===</span> originArray<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
cloneArray<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1,2,3,4,5,6]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>originArray<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>深拷贝</li></ul> <ol><li>json转换:JSON.parse(JSON.stringify(obj));</li></ol> <h5 id="注意：进行json-stringify-序列化的过程中，undefined、任意的函数以及-symbol-值，在序列化过程中会被忽略（出现在非数组对象的属性值中时）或者被转换成-null（出现在数组中时）"><a href="#注意：进行json-stringify-序列化的过程中，undefined、任意的函数以及-symbol-值，在序列化过程中会被忽略（出现在非数组对象的属性值中时）或者被转换成-null（出现在数组中时）" class="header-anchor">#</a> 注意：进行JSON.stringify()序列化的过程中，undefined、任意的函数以及 symbol 值，在序列化过程中会被忽略（出现在非数组对象的属性值中时）或者被转换成 null（出现在数组中时）</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    x<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> 
    y<span class="token operator">:</span> <span class="token punctuation">{</span>
        m<span class="token operator">:</span> <span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    a<span class="token operator">:</span><span class="token keyword">undefined</span><span class="token punctuation">,</span>
    <span class="token function-variable function">b</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span>b</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> a<span class="token operator">+</span>b
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    c<span class="token operator">:</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj2 <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span> <span class="token comment">//{x: 1, y: {m: 1}, a: undefined, b: ƒ, c: Symbol(foo)}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span> <span class="token comment">//{x: 1, y: {m: 1}}</span>
obj2<span class="token punctuation">.</span>y<span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> <span class="token comment">//修改obj2.y.m</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span> <span class="token comment">//{x: 1, y: {m: 1}, a: undefined, b: ƒ, c: Symbol(foo)}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj2<span class="token punctuation">)</span> <span class="token comment">//{x: 2, y: {m: 2}}</span>

</code></pre></div><ol start="2"><li>浅克隆+递归</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>   <span class="token keyword">function</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token parameter">target</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> target <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">let</span> cloneTarget <span class="token operator">=</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

                    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> key <span class="token keyword">in</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        cloneTarget<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">clone</span><span class="token punctuation">(</span>target<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>

                    <span class="token keyword">return</span> cloneTarget
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> target
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
</code></pre></div><h2 id="八-事件传播的三个阶段"><a href="#八-事件传播的三个阶段" class="header-anchor">#</a> 八.事件传播的三个阶段</h2> <ul><li>捕获阶段–事件从 window 开始，然后向下到每个元素，直到到达目标元素事件或event.target。window----&gt; document----&gt; html----&gt; body ----&gt;目标元素</li> <li>目标阶段–事件已达到目标元素。</li> <li>冒泡阶段–事件从目标元素冒泡，然后上升到每个元素，直到到达 window。当前元素----&gt;body ----&gt; html----&gt;document ----&gt;window</li></ul> <h2 id="九-es6新增方法"><a href="#九-es6新增方法" class="header-anchor">#</a> 九.ES6新增方法</h2> <p>1.字符串的方法</p> <ul><li>includes(), startsWith(), endsWith()</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">'Hello world!'</span><span class="token punctuation">;</span>

s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
s<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'!'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
s<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'o'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
<span class="token comment">//这三个方法都支持第二个参数，表示开始搜索的位置。</span>



s<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'world'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
s<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token comment">// true</span>
s<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><ul><li>repeat():repeat方法返回一个新字符串，表示将原字符串重复n次。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'x'</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token comment">// &quot;xxx&quot;</span>
<span class="token string">'hello'</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// &quot;hellohello&quot;</span>
<span class="token string">'na'</span><span class="token punctuation">.</span><span class="token function">repeat</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// </span>
</code></pre></div><ul><li>padStart()，padEnd():一共接受两个参数，第一个参数是字符串补全生效的最大长度，第二个参数是用来补全的字符串,如果原字符串的长度，等于或大于最大长度，则字符串补全不生效，返回原字符串</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'xxx'</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'ab'</span><span class="token punctuation">)</span> <span class="token comment">// 'xxx'</span>
<span class="token string">'xxx'</span><span class="token punctuation">.</span><span class="token function">padEnd</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'ab'</span><span class="token punctuation">)</span> <span class="token comment">// 'xxx'</span>
<span class="token comment">//如果用来补全的字符串与原字符串，两者的长度之和超过了最大长度，则会截去超出位数的补全字符串。</span>

<span class="token string">'abc'</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'0123456789'</span><span class="token punctuation">)</span>
<span class="token comment">// '0123456abc'</span>
<span class="token comment">//如果省略第二个参数，默认使用空格补全长度。</span>

<span class="token string">'x'</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// '   x'</span>
<span class="token string">'x'</span><span class="token punctuation">.</span><span class="token function">padEnd</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token comment">// 'x   '</span>
<span class="token comment">//padStart()的常见用途是为数值补全指定位数。下面代码生成 10 位的数值字符串。</span>

<span class="token string">'1'</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;0000000001&quot;</span>
<span class="token string">'12'</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;0000000012&quot;</span>
<span class="token string">'123456'</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;0000123456&quot;</span>
另一个用途是提示字符串格式。

<span class="token string">'12'</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'YYYY-MM-DD'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;YYYY-MM-12&quot;</span>
<span class="token string">'09-12'</span><span class="token punctuation">.</span><span class="token function">padStart</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'YYYY-MM-DD'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;YYYY-09-12&quot;</span>

</code></pre></div><ul><li>trimStart()，trimEnd() 消除空格,对字符串头部（或尾部）的 tab 键、换行符等不可见的空白符号也有效。,返回的都是新字符串，不会修改原始字符串。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> s <span class="token operator">=</span> <span class="token string">'  abc  '</span><span class="token punctuation">;</span>

s<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;abc&quot;</span>
s<span class="token punctuation">.</span><span class="token function">trimStart</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;abc  &quot;</span>
s<span class="token punctuation">.</span><span class="token function">trimEnd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;  abc&quot;</span>

</code></pre></div><ul><li>matchAll() ：返回一个正则表达式在当前字符串的所有匹配</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token keyword">let</span> regexp <span class="token operator">=</span> <span class="token regex">/t(e)(st(\d?))/g</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">'test1test2'</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>str<span class="token punctuation">.</span><span class="token function">matchAll</span><span class="token punctuation">(</span>regexp<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// expected output: Array [&quot;test1&quot;, &quot;e&quot;, &quot;st1&quot;, &quot;1&quot;]</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// expected output: Array [&quot;test2&quot;, &quot;e&quot;, &quot;st2&quot;, &quot;2&quot;]</span>
</code></pre></div><h2 id="十-防抖和节流"><a href="#十-防抖和节流" class="header-anchor">#</a> 十.防抖和节流</h2> <ul><li>防抖:在事件被触发n秒后再执行回调，如果在这n秒内又被触发，则重新计时。
将若干个函数调用合成为一次，并在给定时间过去之后仅被调用一次。</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">debounce</span><span class="token punctuation">(</span><span class="token parameter">fn<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 维护一个 timer，用来记录当前执行函数状态</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 通过 ‘this’ 和 ‘arguments’ 获取函数的作用域和变量</span>
    <span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> args <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    <span class="token comment">// 清理掉正在执行的函数，并重新执行</span>
    <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> flag <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 记录当前函数调用次数</span>
<span class="token comment">// 当用户滚动时被调用的函数</span>
<span class="token keyword">function</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  flag<span class="token operator">++</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Number of calls: %d'</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 在 debounce 中包装我们的函数，过 2 秒触发一次</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> <span class="token function">debounce</span><span class="token punctuation">(</span>foo<span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><ul><li>节流:指定时间间隔内只会执行一次任务</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token number">1</span><span class="token punctuation">)</span>时间戳实现：
<span class="token keyword">function</span> <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> prev <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> args    <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    <span class="token keyword">const</span> now     <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>now <span class="token operator">-</span> prev <span class="token operator">&gt;=</span> delay<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
      prev <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token number">2</span>）定时器实现：
fucntion <span class="token function">throttle</span><span class="token punctuation">(</span><span class="token parameter">func<span class="token punctuation">,</span> delay</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token function">funtion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> args    <span class="token operator">=</span> arguments<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>timer<span class="token punctuation">)</span><span class="token punctuation">{</span>
      timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token function">func</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="十一-闭包"><a href="#十一-闭包" class="header-anchor">#</a> 十一.闭包</h2></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/web-doc/assets/js/app.d31740f5.js" defer></script><script src="/web-doc/assets/js/2.b96ff054.js" defer></script><script src="/web-doc/assets/js/31.9203bd46.js" defer></script>
  </body>
</html>
